<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ariel Demo - Mermaid Diagram Viewer</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Mermaid.js -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <style>
        #diagram-container {
            min-height: 400px;
            padding: 20px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        #status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            background-color: #28a745;
        }

        .badge {
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">
                    Ariel - Live Mermaid Diagram Viewer
                    <small class="text-muted fs-6">
                        <span id="status-indicator"></span>
                        <span id="status-text">Demo Mode</span>
                    </small>
                </h1>
                <div class="alert alert-info mb-4">
                    <strong>Demo Mode:</strong> This is a static preview. The live server at
                    <code>http://127.0.0.1:5000</code> polls for changes every second and updates automatically.
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div id="diagram-container">
                    <div class="mermaid">
graph TD
    A[Ariel Server] --> B{Check .mmd file}
    B -->|Modified| C[Read content]
    B -->|Not Modified| D[Return 304]
    C --> E[Call CLI if configured]
    E --> F[Return diagram content]
    F --> G[Browser renders with mermaid.js]
    G --> H[Display SVG diagram]
    D --> I[Browser keeps current diagram]

    style A fill:#e1f5ff
    style H fill:#c8e6c9
    style I fill:#fff9c4
                    </div>
                </div>

                <div class="mt-4">
                    <h3>Features</h3>
                    <div class="row">
                        <div class="col-md-6">
                            <ul>
                                <li><span class="badge bg-success">✓</span> Polls every 1 second</li>
                                <li><span class="badge bg-success">✓</span> HTTP 304 caching</li>
                                <li><span class="badge bg-success">✓</span> Live updates on file changes</li>
                                <li><span class="badge bg-success">✓</span> Bootstrap styling</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <ul>
                                <li><span class="badge bg-success">✓</span> Mermaid.js SVG rendering</li>
                                <li><span class="badge bg-success">✓</span> Error handling with checkerboard</li>
                                <li><span class="badge bg-success">✓</span> Optional CLI program support</li>
                                <li><span class="badge bg-success">✓</span> Status indicators</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="mt-4">
                    <h3>Example Mermaid Diagrams You Can Create</h3>
                    <div class="row mt-3">
                        <div class="col-md-6 mb-4">
                            <h5>Sequence Diagram</h5>
                            <div class="mermaid">
sequenceDiagram
    participant User
    participant Browser
    participant Server
    User->>Browser: Edit .mmd file
    Browser->>Server: Poll /mermaid
    Server->>Browser: Return diagram
    Browser->>User: Display updated SVG
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <h5>State Diagram</h5>
                            <div class="mermaid">
stateDiagram-v2
    [*] --> Idle
    Idle --> Checking: 1 second timer
    Checking --> Updated: File modified
    Checking --> Idle: Not modified (304)
    Updated --> Rendering
    Rendering --> Idle: Display SVG
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-5">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <strong>How to Access the Live Server</strong>
                    </div>
                    <div class="card-body">
                        <ol>
                            <li>Open your web browser</li>
                            <li>Navigate to: <code class="bg-light px-2 py-1">http://127.0.0.1:5000</code></li>
                            <li>Edit <code>diagram.mmd</code> to see live updates</li>
                        </ol>
                        <p class="mb-0 mt-3">
                            <strong>Start the server:</strong> <code class="bg-light px-2 py-1">./start_ariel.sh</code>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="container mt-5 mb-4 text-center text-muted">
        <p>Ariel - Flask Web Server for Live Mermaid Diagram Rendering</p>
    </footer>
</body>
</html>
